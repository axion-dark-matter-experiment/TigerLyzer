<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.11"/>
<title>Tigerlyzer: SingleSpectrum Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Tigerlyzer
   &#160;<span id="projectnumber">1.0</span>
   </div>
   <div id="projectbrief">Analysis program for Electric Tiger</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.11 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li class="current"><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="annotated.html"><span>Class&#160;List</span></a></li>
      <li><a href="classes.html"><span>Class&#160;Index</span></a></li>
      <li><a href="hierarchy.html"><span>Class&#160;Hierarchy</span></a></li>
      <li><a href="functions.html"><span>Class&#160;Members</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('class_single_spectrum.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#friends">Friends</a> &#124;
<a href="class_single_spectrum-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">SingleSpectrum Class Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Class to hold a single power spectrum and its associated parameters, such as center frequency, frequency span, Q etc.  
 <a href="class_single_spectrum.html#details">More...</a></p>

<p><code>#include &lt;<a class="el" href="singlespectrum_8h_source.html">singlespectrum.h</a>&gt;</code></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a4a3601f0303e217a3b58458d5f47c05a"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_single_spectrum.html#a4a3601f0303e217a3b58458d5f47c05a">SingleSpectrum</a> (std::string raw_data)</td></tr>
<tr class="memdesc:a4a3601f0303e217a3b58458d5f47c05a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Build a new <a class="el" href="class_single_spectrum.html" title="Class to hold a single power spectrum and its associated parameters, such as center frequency...">SingleSpectrum</a> from a string of raw data collected from the experiment.  <a href="#a4a3601f0303e217a3b58458d5f47c05a">More...</a><br /></td></tr>
<tr class="separator:a4a3601f0303e217a3b58458d5f47c05a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a964a944ac1fa20c59d18a1aec62ac149"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_single_spectrum.html#a964a944ac1fa20c59d18a1aec62ac149">SingleSpectrum</a> (uint <a class="el" href="class_single_spectrum.html#a42c2d13e632ffc2d4f0931376c5b6e5b">size</a>)</td></tr>
<tr class="memdesc:a964a944ac1fa20c59d18a1aec62ac149"><td class="mdescLeft">&#160;</td><td class="mdescRight">Construct a blank ( all power values and uncertainties = 0 ) <a class="el" href="class_single_spectrum.html" title="Class to hold a single power spectrum and its associated parameters, such as center frequency...">SingleSpectrum</a> with a particular number of enteries.  <a href="#a964a944ac1fa20c59d18a1aec62ac149">More...</a><br /></td></tr>
<tr class="separator:a964a944ac1fa20c59d18a1aec62ac149"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a755b03499ec62001c594ca9977082f82"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_single_spectrum.html#a755b03499ec62001c594ca9977082f82">SingleSpectrum</a> (uint <a class="el" href="class_single_spectrum.html#a42c2d13e632ffc2d4f0931376c5b6e5b">size</a>, double <a class="el" href="class_single_spectrum.html#a6b32df4657d7e4abb9afaedadbd50486">min_freq</a>, double <a class="el" href="class_single_spectrum.html#accb195e89e0fc81ea8a0ba61f0b800ba">max_freq</a>)</td></tr>
<tr class="memdesc:a755b03499ec62001c594ca9977082f82"><td class="mdescLeft">&#160;</td><td class="mdescRight">Construct a blank ( all power values and uncertainties = 0 ) <a class="el" href="class_single_spectrum.html" title="Class to hold a single power spectrum and its associated parameters, such as center frequency...">SingleSpectrum</a> with a particular number of enteries and a particular mim. and max. frequency.  <a href="#a755b03499ec62001c594ca9977082f82">More...</a><br /></td></tr>
<tr class="separator:a755b03499ec62001c594ca9977082f82"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1036113bfa175f06d75b6b5b0607a41d"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a1036113bfa175f06d75b6b5b0607a41d"></a>
<a class="el" href="class_single_spectrum.html">SingleSpectrum</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><b>operator*=</b> (double scalar)</td></tr>
<tr class="separator:a1036113bfa175f06d75b6b5b0607a41d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a324cc374d07ca086f435e8f917eda9ed"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a324cc374d07ca086f435e8f917eda9ed"></a>
<a class="el" href="class_single_spectrum.html">SingleSpectrum</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><b>operator+=</b> (double scalar)</td></tr>
<tr class="separator:a324cc374d07ca086f435e8f917eda9ed"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a68722e243799928f35696b91dd3eec99"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_single_spectrum.html#a68722e243799928f35696b91dd3eec99">InitialBin</a> (uint bin_points=32)</td></tr>
<tr class="memdesc:a68722e243799928f35696b91dd3eec99"><td class="mdescLeft">&#160;</td><td class="mdescRight">Perform initial binning of a raw power spectrum and initializes spectrum uncertainties.  <a href="#a68722e243799928f35696b91dd3eec99">More...</a><br /></td></tr>
<tr class="separator:a68722e243799928f35696b91dd3eec99"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2538a9a9f700323f133379a7c3587bf1"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_single_spectrum.html#a2538a9a9f700323f133379a7c3587bf1">dBmToWatts</a> ()</td></tr>
<tr class="memdesc:a2538a9a9f700323f133379a7c3587bf1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Covert from units of dBm to Watts.  <a href="#a2538a9a9f700323f133379a7c3587bf1">More...</a><br /></td></tr>
<tr class="separator:a2538a9a9f700323f133379a7c3587bf1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aab066652966cbd493157ba60449e78ee"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_single_spectrum.html#aab066652966cbd493157ba60449e78ee">WattsToExcessPower</a> ()</td></tr>
<tr class="memdesc:aab066652966cbd493157ba60449e78ee"><td class="mdescLeft">&#160;</td><td class="mdescRight">Convert from units of Watts to ExcessPower, i.e. Watts above power due to noise.  <a href="#aab066652966cbd493157ba60449e78ee">More...</a><br /></td></tr>
<tr class="separator:aab066652966cbd493157ba60449e78ee"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aff7c0ae4597282530e2e7bfbab305dcf"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_single_spectrum.html#aff7c0ae4597282530e2e7bfbab305dcf">KSVZWeight</a> ()</td></tr>
<tr class="memdesc:aff7c0ae4597282530e2e7bfbab305dcf"><td class="mdescLeft">&#160;</td><td class="mdescRight">Convert spectrum from units of Excess power to units of <img class="formulaInl" alt="$ g_{\gamma\gamma} $" src="form_15.png"/>.  <a href="#aff7c0ae4597282530e2e7bfbab305dcf">More...</a><br /></td></tr>
<tr class="separator:aff7c0ae4597282530e2e7bfbab305dcf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3069daec9b412a1d9a98b67cd9bc5aa2"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_single_spectrum.html#a3069daec9b412a1d9a98b67cd9bc5aa2">LorentzianWeight</a> ()</td></tr>
<tr class="memdesc:a3069daec9b412a1d9a98b67cd9bc5aa2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Weight each point in the spectrum by how far away it is from the center frequency.  <a href="#a3069daec9b412a1d9a98b67cd9bc5aa2">More...</a><br /></td></tr>
<tr class="separator:a3069daec9b412a1d9a98b67cd9bc5aa2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aff85f0cdffc9818b2c9689e768d925b7"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="aff85f0cdffc9818b2c9689e768d925b7"></a>
double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_single_spectrum.html#aff85f0cdffc9818b2c9689e768d925b7">norm</a> ()</td></tr>
<tr class="memdesc:aff85f0cdffc9818b2c9689e768d925b7"><td class="mdescLeft">&#160;</td><td class="mdescRight">Compute the <img class="formulaInl" alt="$ L_2 $" src="form_19.png"/> norm of the current spectrum = <img class="formulaInl" alt="$ \sqrt{\sum_{i=1}^n | P_i |^2} $" src="form_20.png"/> Then. <br /></td></tr>
<tr class="separator:aff85f0cdffc9818b2c9689e768d925b7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a39f66345fd7d6502bbc8ba731cc1bb13"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a39f66345fd7d6502bbc8ba731cc1bb13"></a>
double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_single_spectrum.html#a39f66345fd7d6502bbc8ba731cc1bb13">mean</a> ()</td></tr>
<tr class="memdesc:a39f66345fd7d6502bbc8ba731cc1bb13"><td class="mdescLeft">&#160;</td><td class="mdescRight">Compute the arithmetic mean of the current spectrum. <br /></td></tr>
<tr class="separator:a39f66345fd7d6502bbc8ba731cc1bb13"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a138e3db04f9db67a699c8dddfef8f324"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a138e3db04f9db67a699c8dddfef8f324"></a>
double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_single_spectrum.html#a138e3db04f9db67a699c8dddfef8f324">std_dev</a> ()</td></tr>
<tr class="memdesc:a138e3db04f9db67a699c8dddfef8f324"><td class="mdescLeft">&#160;</td><td class="mdescRight">Compute the standard deviation of the current spectrum. <br /></td></tr>
<tr class="separator:a138e3db04f9db67a699c8dddfef8f324"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6b32df4657d7e4abb9afaedadbd50486"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a6b32df4657d7e4abb9afaedadbd50486"></a>
double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_single_spectrum.html#a6b32df4657d7e4abb9afaedadbd50486">min_freq</a> ()</td></tr>
<tr class="memdesc:a6b32df4657d7e4abb9afaedadbd50486"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get the minimum (smallest) frequency stored in the current spectrum. <br /></td></tr>
<tr class="separator:a6b32df4657d7e4abb9afaedadbd50486"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:accb195e89e0fc81ea8a0ba61f0b800ba"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="accb195e89e0fc81ea8a0ba61f0b800ba"></a>
double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_single_spectrum.html#accb195e89e0fc81ea8a0ba61f0b800ba">max_freq</a> ()</td></tr>
<tr class="memdesc:accb195e89e0fc81ea8a0ba61f0b800ba"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get the maximum (largest) frequency stored in the current spectrum. <br /></td></tr>
<tr class="separator:accb195e89e0fc81ea8a0ba61f0b800ba"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a42c2d13e632ffc2d4f0931376c5b6e5b"><td class="memItemLeft" align="right" valign="top">uint&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_single_spectrum.html#a42c2d13e632ffc2d4f0931376c5b6e5b">size</a> ()</td></tr>
<tr class="memdesc:a42c2d13e632ffc2d4f0931376c5b6e5b"><td class="mdescLeft">&#160;</td><td class="mdescRight">similar to std::vector::size(), get the number of points in the current spectrum.  <a href="#a42c2d13e632ffc2d4f0931376c5b6e5b">More...</a><br /></td></tr>
<tr class="separator:a42c2d13e632ffc2d4f0931376c5b6e5b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a20a4b8c22c80d84341e4226f43a54c50"><td class="memItemLeft" align="right" valign="top">std::string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_single_spectrum.html#a20a4b8c22c80d84341e4226f43a54c50">units</a> ()</td></tr>
<tr class="memdesc:a20a4b8c22c80d84341e4226f43a54c50"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get the current units that the <a class="el" href="class_spectrum.html" title="Container class designed to hold all the individual spectra collected in a data run. ">Spectrum</a> is in.  <a href="#a20a4b8c22c80d84341e4226f43a54c50">More...</a><br /></td></tr>
<tr class="separator:a20a4b8c22c80d84341e4226f43a54c50"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac39957d9b67a322272d1089aa6dd6c4c"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_single_spectrum.html#ac39957d9b67a322272d1089aa6dd6c4c">rebin</a> (uint points_per_bin)</td></tr>
<tr class="memdesc:ac39957d9b67a322272d1089aa6dd6c4c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Rebin the current spectra, averaging all power spectrum points and uncertainties.  <a href="#ac39957d9b67a322272d1089aa6dd6c4c">More...</a><br /></td></tr>
<tr class="separator:ac39957d9b67a322272d1089aa6dd6c4c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afea78595e8232ecb15f3c2f5d825cef1"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_single_spectrum.html#afea78595e8232ecb15f3c2f5d825cef1">chop_bins</a> (uint start_chop, uint end_chop)</td></tr>
<tr class="memdesc:afea78595e8232ecb15f3c2f5d825cef1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Elminate bins from the head and tail of the current spectrum.  <a href="#afea78595e8232ecb15f3c2f5d825cef1">More...</a><br /></td></tr>
<tr class="separator:afea78595e8232ecb15f3c2f5d825cef1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2bda515f49feea97f76bd06f441a9c2d"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_single_spectrum.html#a2bda515f49feea97f76bd06f441a9c2d">bin_start_freq</a> (uint idx)</td></tr>
<tr class="memdesc:a2bda515f49feea97f76bd06f441a9c2d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get the frequency corresponding to the left-hand side of a bin.  <a href="#a2bda515f49feea97f76bd06f441a9c2d">More...</a><br /></td></tr>
<tr class="separator:a2bda515f49feea97f76bd06f441a9c2d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0a1e03366e1b482decd42326187cdcf5"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_single_spectrum.html#a0a1e03366e1b482decd42326187cdcf5">bin_mid_freq</a> (uint idx)</td></tr>
<tr class="memdesc:a0a1e03366e1b482decd42326187cdcf5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get the frequency corresponding to the center of a bin.  <a href="#a0a1e03366e1b482decd42326187cdcf5">More...</a><br /></td></tr>
<tr class="separator:a0a1e03366e1b482decd42326187cdcf5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aad6dfbabe270fbc5ac7ce0dafdb77197"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_single_spectrum.html#aad6dfbabe270fbc5ac7ce0dafdb77197">bin_width</a> ()</td></tr>
<tr class="memdesc:aad6dfbabe270fbc5ac7ce0dafdb77197"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get the frequency corresponding to the right-hand side of a bin.  <a href="#aad6dfbabe270fbc5ac7ce0dafdb77197">More...</a><br /></td></tr>
<tr class="separator:aad6dfbabe270fbc5ac7ce0dafdb77197"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a98378d6007966e7706624f55ea35b975"><td class="memItemLeft" align="right" valign="top">uint&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_single_spectrum.html#a98378d6007966e7706624f55ea35b975">bin_at_frequency</a> (double frequency)</td></tr>
<tr class="memdesc:a98378d6007966e7706624f55ea35b975"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get the index of the bin correspond to a given frequency.  <a href="#a98378d6007966e7706624f55ea35b975">More...</a><br /></td></tr>
<tr class="separator:a98378d6007966e7706624f55ea35b975"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="friends"></a>
Friends</h2></td></tr>
<tr class="memitem:a6ba91d2d92db2828951645e19e0a0384"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a6ba91d2d92db2828951645e19e0a0384"></a>
bool&#160;</td><td class="memItemRight" valign="bottom"><b>operator==</b> (<a class="el" href="class_single_spectrum.html">SingleSpectrum</a> &amp;spectra_a, <a class="el" href="class_single_spectrum.html">SingleSpectrum</a> &amp;spectra_b)</td></tr>
<tr class="separator:a6ba91d2d92db2828951645e19e0a0384"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae0a9f33112a5508cf8d5613a165c11df"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ae0a9f33112a5508cf8d5613a165c11df"></a>
bool&#160;</td><td class="memItemRight" valign="bottom"><b>operator!=</b> (<a class="el" href="class_single_spectrum.html">SingleSpectrum</a> &amp;spectra_a, <a class="el" href="class_single_spectrum.html">SingleSpectrum</a> &amp;spectra_b)</td></tr>
<tr class="separator:ae0a9f33112a5508cf8d5613a165c11df"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a260e8ff3518714d32d964dd7e2a6bf39"><td class="memItemLeft" align="right" valign="top">std::ostream &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_single_spectrum.html#a260e8ff3518714d32d964dd7e2a6bf39">operator&lt;&lt;</a> (std::ostream &amp;stream, <a class="el" href="class_single_spectrum.html">SingleSpectrum</a> &amp;spectrum)</td></tr>
<tr class="memdesc:a260e8ff3518714d32d964dd7e2a6bf39"><td class="mdescLeft">&#160;</td><td class="mdescRight">Operator for printing spectrum contents to std::cout or similar Only power data will be accessed and printed.  <a href="#a260e8ff3518714d32d964dd7e2a6bf39">More...</a><br /></td></tr>
<tr class="separator:a260e8ff3518714d32d964dd7e2a6bf39"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa4fcc146ff71fd379f2e6dab83125c74"><td class="memItemLeft" align="right" valign="top">std::ofstream &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_single_spectrum.html#aa4fcc146ff71fd379f2e6dab83125c74">operator&lt;&lt;</a> (std::ofstream &amp;stream, <a class="el" href="class_single_spectrum.html">SingleSpectrum</a> &amp;spectrum)</td></tr>
<tr class="memdesc:aa4fcc146ff71fd379f2e6dab83125c74"><td class="mdescLeft">&#160;</td><td class="mdescRight">Operator for saving spectra to files Unlike the ostream version, both the header and power data are accessed.  <a href="#aa4fcc146ff71fd379f2e6dab83125c74">More...</a><br /></td></tr>
<tr class="separator:aa4fcc146ff71fd379f2e6dab83125c74"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac71261d3ce99c4028fae4996736a72b3"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ac71261d3ce99c4028fae4996736a72b3"></a>
<a class="el" href="class_single_spectrum.html">SingleSpectrum</a>&#160;</td><td class="memItemRight" valign="bottom"><b>operator*</b> (<a class="el" href="class_single_spectrum.html">SingleSpectrum</a> &amp;spectra_a, <a class="el" href="class_single_spectrum.html">SingleSpectrum</a> &amp;spectra_b)</td></tr>
<tr class="separator:ac71261d3ce99c4028fae4996736a72b3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aff381ffcc9205b4b376b6af20c6bd98d"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="aff381ffcc9205b4b376b6af20c6bd98d"></a>
<a class="el" href="class_single_spectrum.html">SingleSpectrum</a>&#160;</td><td class="memItemRight" valign="bottom"><b>operator+</b> (<a class="el" href="class_single_spectrum.html">SingleSpectrum</a> &amp;spectra_a, <a class="el" href="class_single_spectrum.html">SingleSpectrum</a> &amp;spectra_b)</td></tr>
<tr class="separator:aff381ffcc9205b4b376b6af20c6bd98d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a323a1a48dc567b58ac1a4ef41ddd06c7"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a323a1a48dc567b58ac1a4ef41ddd06c7"></a>
<a class="el" href="class_single_spectrum.html">SingleSpectrum</a>&#160;</td><td class="memItemRight" valign="bottom"><b>operator-</b> (<a class="el" href="class_single_spectrum.html">SingleSpectrum</a> &amp;spectra_a, <a class="el" href="class_single_spectrum.html">SingleSpectrum</a> &amp;spectra_b)</td></tr>
<tr class="separator:a323a1a48dc567b58ac1a4ef41ddd06c7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a03a486faf7f42ef4c5e407cf510a8ac8"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a03a486faf7f42ef4c5e407cf510a8ac8"></a>
<a class="el" href="class_single_spectrum.html">SingleSpectrum</a>&#160;</td><td class="memItemRight" valign="bottom"><b>operator*</b> (<a class="el" href="class_single_spectrum.html">SingleSpectrum</a> &amp;spectra_a, std::vector&lt; double &gt; &amp;spectra_b)</td></tr>
<tr class="separator:a03a486faf7f42ef4c5e407cf510a8ac8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a94b2bcfa34d2a268cf575ed0310f9862"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a94b2bcfa34d2a268cf575ed0310f9862"></a>
<a class="el" href="class_single_spectrum.html">SingleSpectrum</a>&#160;</td><td class="memItemRight" valign="bottom"><b>operator+</b> (<a class="el" href="class_single_spectrum.html">SingleSpectrum</a> &amp;spectra_a, std::vector&lt; double &gt; &amp;spectra_b)</td></tr>
<tr class="separator:a94b2bcfa34d2a268cf575ed0310f9862"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af09eb1e4819bdc296e86ae5184801c15"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="af09eb1e4819bdc296e86ae5184801c15"></a>
<a class="el" href="class_single_spectrum.html">SingleSpectrum</a>&#160;</td><td class="memItemRight" valign="bottom"><b>operator-</b> (<a class="el" href="class_single_spectrum.html">SingleSpectrum</a> &amp;spectra_a, std::vector&lt; double &gt; &amp;spectra_b)</td></tr>
<tr class="separator:af09eb1e4819bdc296e86ae5184801c15"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a57b28b2f85f69f4a3701addd9b895af0"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a57b28b2f85f69f4a3701addd9b895af0"></a>
<a class="el" href="class_single_spectrum.html">SingleSpectrum</a>&#160;</td><td class="memItemRight" valign="bottom"><b>operator*</b> (<a class="el" href="class_single_spectrum.html">SingleSpectrum</a> &amp;spectra_a, double scalar)</td></tr>
<tr class="separator:a57b28b2f85f69f4a3701addd9b895af0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af97afd20ae8d5e39f4888b388659de97"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="af97afd20ae8d5e39f4888b388659de97"></a>
<a class="el" href="class_single_spectrum.html">SingleSpectrum</a>&#160;</td><td class="memItemRight" valign="bottom"><b>operator+</b> (<a class="el" href="class_single_spectrum.html">SingleSpectrum</a> &amp;spectra_a, double scalar)</td></tr>
<tr class="separator:af97afd20ae8d5e39f4888b388659de97"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2806929612f916b2e5f279cc7fd04f54"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a2806929612f916b2e5f279cc7fd04f54"></a>
<a class="el" href="class_single_spectrum.html">SingleSpectrum</a>&#160;</td><td class="memItemRight" valign="bottom"><b>operator-</b> (<a class="el" href="class_single_spectrum.html">SingleSpectrum</a> &amp;spectra_a, double scalar)</td></tr>
<tr class="separator:a2806929612f916b2e5f279cc7fd04f54"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af6ea635ec0d3f68b648f1e4ce2f04a83"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_single_spectrum.html#af6ea635ec0d3f68b648f1e4ce2f04a83">plot</a> (<a class="el" href="class_single_spectrum.html">SingleSpectrum</a> &amp;spec, std::string plot_title, std::string save_file_path)</td></tr>
<tr class="memdesc:af6ea635ec0d3f68b648f1e4ce2f04a83"><td class="mdescLeft">&#160;</td><td class="mdescRight">Plot a <a class="el" href="class_single_spectrum.html" title="Class to hold a single power spectrum and its associated parameters, such as center frequency...">SingleSpectrum</a> object as a connected line graph.  <a href="#af6ea635ec0d3f68b648f1e4ce2f04a83">More...</a><br /></td></tr>
<tr class="separator:af6ea635ec0d3f68b648f1e4ce2f04a83"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a30c341f2a001107ecb26dfb82a41ab60"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_single_spectrum.html#a30c341f2a001107ecb26dfb82a41ab60">plot</a> (<a class="el" href="class_single_spectrum.html">SingleSpectrum</a> &amp;spec, uint num_plot_points, std::string plot_title, std::string save_file_path)</td></tr>
<tr class="memdesc:a30c341f2a001107ecb26dfb82a41ab60"><td class="mdescLeft">&#160;</td><td class="mdescRight">Plot a <a class="el" href="class_single_spectrum.html" title="Class to hold a single power spectrum and its associated parameters, such as center frequency...">SingleSpectrum</a> object as a point graphic with error bars.  <a href="#a30c341f2a001107ecb26dfb82a41ab60">More...</a><br /></td></tr>
<tr class="separator:a30c341f2a001107ecb26dfb82a41ab60"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5e7f22c72498af588353d6f9dd2d249d"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_single_spectrum.html#a5e7f22c72498af588353d6f9dd2d249d">GaussianFilter</a> (<a class="el" href="class_single_spectrum.html">SingleSpectrum</a> &amp;spec, uint radius)</td></tr>
<tr class="memdesc:a5e7f22c72498af588353d6f9dd2d249d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Convolve a <a class="el" href="class_single_spectrum.html" title="Class to hold a single power spectrum and its associated parameters, such as center frequency...">SingleSpectrum</a> object with a Gaussian kernel.  <a href="#a5e7f22c72498af588353d6f9dd2d249d">More...</a><br /></td></tr>
<tr class="separator:a5e7f22c72498af588353d6f9dd2d249d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad01cdeca98f7daa5c3c9d6b96debcaa2"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_single_spectrum.html#ad01cdeca98f7daa5c3c9d6b96debcaa2">UnsharpMask</a> (<a class="el" href="class_single_spectrum.html">SingleSpectrum</a> &amp;spec, uint radius, double sigma)</td></tr>
<tr class="memdesc:ad01cdeca98f7daa5c3c9d6b96debcaa2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Subtract background structure from a <a class="el" href="class_single_spectrum.html" title="Class to hold a single power spectrum and its associated parameters, such as center frequency...">SingleSpectrum</a> using a high-pass filter.  <a href="#ad01cdeca98f7daa5c3c9d6b96debcaa2">More...</a><br /></td></tr>
<tr class="separator:ad01cdeca98f7daa5c3c9d6b96debcaa2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a99a9383be5a37813742c991db9c468c2"><td class="memItemLeft" align="right" valign="top">std::pair&lt; uint, double &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_single_spectrum.html#a99a9383be5a37813742c991db9c468c2">AutoOptimize</a> (<a class="el" href="class_single_spectrum.html">SingleSpectrum</a> &amp;spec, uint max_radius, uint max_sigma)</td></tr>
<tr class="memdesc:a99a9383be5a37813742c991db9c468c2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Compute the ideal radius to be used for background subtraction using the UnsharpMask function.  <a href="#a99a9383be5a37813742c991db9c468c2">More...</a><br /></td></tr>
<tr class="separator:a99a9383be5a37813742c991db9c468c2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6576d807eb2b793170ca8f89059998f7"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a6576d807eb2b793170ca8f89059998f7"></a>
<a class="el" href="class_single_spectrum.html">SingleSpectrum</a>&#160;</td><td class="memItemRight" valign="bottom"><b>Spectrum::GrandSpectrum</b> ()</td></tr>
<tr class="separator:a6576d807eb2b793170ca8f89059998f7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae1b364ad4cb640b9bfdfe94ee7310674"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ae1b364ad4cb640b9bfdfe94ee7310674"></a>
<a class="el" href="class_single_spectrum.html">SingleSpectrum</a>&#160;</td><td class="memItemRight" valign="bottom"><b>Spectrum::Limits</b> ()</td></tr>
<tr class="separator:ae1b364ad4cb640b9bfdfe94ee7310674"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Class to hold a single power spectrum and its associated parameters, such as center frequency, frequency span, Q etc. </p>
<p>Class is designed to 'look and feel' like a <img class="formulaInl" alt="$ \mathcal{R}^n $" src="form_0.png"/> vector. Spectra allows scalar multiplication and addition, along with 'vector' multiplication and addition.</p>
<p>Further each <a class="el" href="class_single_spectrum.html" title="Class to hold a single power spectrum and its associated parameters, such as center frequency...">SingleSpectrum</a> tracks its own uncertainties and current units. </p>

<p>Definition at line <a class="el" href="singlespectrum_8h_source.html#l00029">29</a> of file <a class="el" href="singlespectrum_8h_source.html">singlespectrum.h</a>.</p>
</div><h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a class="anchor" id="a4a3601f0303e217a3b58458d5f47c05a"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">SingleSpectrum::SingleSpectrum </td>
          <td>(</td>
          <td class="paramtype">std::string&#160;</td>
          <td class="paramname"><em>raw_data</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Build a new <a class="el" href="class_single_spectrum.html" title="Class to hold a single power spectrum and its associated parameters, such as center frequency...">SingleSpectrum</a> from a string of raw data collected from the experiment. </p>
<p>Electric Tiger collects one data set per cavity length and saves the results as a plain text (.csv) file. The first few lines of each data file are the "header" and contain experiment parameters such as cavity length, peak center frequency, Quality Factor etc. Each entry in the header file is has the form "parameter;value".</p>
<p>At the end of the header file is a token, usually "@". Beyond this token is the collected power spectrum. Each value in the spectrum is a floating point value followed by a newline. Below is a sample data file:</p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\begin{verbatim} sa_span;10 fft_length;131072 effective_volume;0.1 bfield;1.54 noise_temperature;400 sa_averages;256 Q;128.4913492063492 actual_center_freq;4037.3840399002493 fitted_hwhm;15.71072319201995 cavity_length;7.693 @ -116.0639877 -116.0132904 -115.6643753 -116.1841431 -115.1884918 etc... \end{verbatim}" src="form_13.png"/>
</p>
<p>It should be noted that the header string must contain particular enteries on the constructor will throw an exception. In particular the keys </p><p class="formulaDsp">
<img class="formulaDsp" alt="\begin{verbatim} &quot;sa_span&quot;, &quot;fft_length&quot;, &quot;effective_volume&quot;, &quot;bfield&quot;, &quot;noise_temperature&quot;, &quot;sa_averages&quot;, &quot;Q&quot;, &quot;actual_center_freq&quot;, &quot;fitted_hwhm&quot;, &quot;bfield&quot; \end{verbatim}" src="form_14.png"/>
</p>
<p>Must all be present.</p>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname">std::invalid_argument</td><td>Thrown if the header is missing certain keys or is formatted incorrectly.</td></tr>
  </table>
  </dd>
</dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">raw_data</td><td>A std::string containing the -entire- contents of a data file. </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="singlespectrum_8cpp_source.html#l00033">33</a> of file <a class="el" href="singlespectrum_8cpp_source.html">singlespectrum.cpp</a>.</p>

</div>
</div>
<a class="anchor" id="a964a944ac1fa20c59d18a1aec62ac149"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">SingleSpectrum::SingleSpectrum </td>
          <td>(</td>
          <td class="paramtype">uint&#160;</td>
          <td class="paramname"><em>size</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Construct a blank ( all power values and uncertainties = 0 ) <a class="el" href="class_single_spectrum.html" title="Class to hold a single power spectrum and its associated parameters, such as center frequency...">SingleSpectrum</a> with a particular number of enteries. </p>
<p>Note that blank spectra do will start with all physical parameters, such as min. and max. frequency set to zero.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">size</td><td>The number of enteries that the blank spectrum should have. </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="singlespectrum_8cpp_source.html#l00041">41</a> of file <a class="el" href="singlespectrum_8cpp_source.html">singlespectrum.cpp</a>.</p>

</div>
</div>
<a class="anchor" id="a755b03499ec62001c594ca9977082f82"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">SingleSpectrum::SingleSpectrum </td>
          <td>(</td>
          <td class="paramtype">uint&#160;</td>
          <td class="paramname"><em>size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>min_freq</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>max_freq</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Construct a blank ( all power values and uncertainties = 0 ) <a class="el" href="class_single_spectrum.html" title="Class to hold a single power spectrum and its associated parameters, such as center frequency...">SingleSpectrum</a> with a particular number of enteries and a particular mim. and max. frequency. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">size</td><td>The number of enteries that the blank spectrum should have.</td></tr>
    <tr><td class="paramname">min_freq</td><td>The minimum frequency of the spectrum in MHz.</td></tr>
    <tr><td class="paramname">max_freq</td><td>The maximum frequency of the spectrum in MHz. </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="singlespectrum_8cpp_source.html#l00046">46</a> of file <a class="el" href="singlespectrum_8cpp_source.html">singlespectrum.cpp</a>.</p>

</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a class="anchor" id="a98378d6007966e7706624f55ea35b975"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint SingleSpectrum::bin_at_frequency </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>frequency</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Get the index of the bin correspond to a given frequency. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">frequency</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd></dd></dl>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname">std::out_of_range</td><td>Thrown if the requested frequency is not in the current spectrum, that is if frequency <img class="formulaInl" alt="$ \notin $" src="form_27.png"/> [ <a class="el" href="class_single_spectrum.html#a6b32df4657d7e4abb9afaedadbd50486" title="Get the minimum (smallest) frequency stored in the current spectrum. ">min_freq()</a>, <a class="el" href="class_single_spectrum.html#accb195e89e0fc81ea8a0ba61f0b800ba" title="Get the maximum (largest) frequency stored in the current spectrum. ">max_freq()</a> ] </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="singlespectrum_8cpp_source.html#l00458">458</a> of file <a class="el" href="singlespectrum_8cpp_source.html">singlespectrum.cpp</a>.</p>

</div>
</div>
<a class="anchor" id="a0a1e03366e1b482decd42326187cdcf5"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double SingleSpectrum::bin_mid_freq </td>
          <td>(</td>
          <td class="paramtype">uint&#160;</td>
          <td class="paramname"><em>idx</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Get the frequency corresponding to the center of a bin. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">idx</td><td>The index of the requested bin </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd></dd></dl>

<p>Definition at line <a class="el" href="singlespectrum_8cpp_source.html#l00479">479</a> of file <a class="el" href="singlespectrum_8cpp_source.html">singlespectrum.cpp</a>.</p>

</div>
</div>
<a class="anchor" id="a2bda515f49feea97f76bd06f441a9c2d"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double SingleSpectrum::bin_start_freq </td>
          <td>(</td>
          <td class="paramtype">uint&#160;</td>
          <td class="paramname"><em>idx</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Get the frequency corresponding to the left-hand side of a bin. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">idx</td><td>The index of the requested bin </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd></dd></dl>

<p>Definition at line <a class="el" href="singlespectrum_8cpp_source.html#l00450">450</a> of file <a class="el" href="singlespectrum_8cpp_source.html">singlespectrum.cpp</a>.</p>

</div>
</div>
<a class="anchor" id="aad6dfbabe270fbc5ac7ce0dafdb77197"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double SingleSpectrum::bin_width </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Get the frequency corresponding to the right-hand side of a bin. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">idx</td><td>The index of the requested bin </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd></dd></dl>

<p>Definition at line <a class="el" href="singlespectrum_8cpp_source.html#l00446">446</a> of file <a class="el" href="singlespectrum_8cpp_source.html">singlespectrum.cpp</a>.</p>

</div>
</div>
<a class="anchor" id="afea78595e8232ecb15f3c2f5d825cef1"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void SingleSpectrum::chop_bins </td>
          <td>(</td>
          <td class="paramtype">uint&#160;</td>
          <td class="paramname"><em>start_chop</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint&#160;</td>
          <td class="paramname"><em>end_chop</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Elminate bins from the head and tail of the current spectrum. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">start_chop</td><td>All points with indices 0 <img class="formulaInl" alt="$ \leq $" src="form_26.png"/> start_chop will be removed.</td></tr>
    <tr><td class="paramname">end_chop</td><td>All points with indices end_chop <img class="formulaInl" alt="$ \leq $" src="form_26.png"/> <a class="el" href="class_single_spectrum.html#a42c2d13e632ffc2d4f0931376c5b6e5b" title="similar to std::vector::size(), get the number of points in the current spectrum. ...">size()</a> will be removed. </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="singlespectrum_8cpp_source.html#l00521">521</a> of file <a class="el" href="singlespectrum_8cpp_source.html">singlespectrum.cpp</a>.</p>

</div>
</div>
<a class="anchor" id="a2538a9a9f700323f133379a7c3587bf1"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void SingleSpectrum::dBmToWatts </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Covert from units of dBm to Watts. </p>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname">std::invalid_argument</td><td>Thrown if spectrum is not in units of dBm. </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="singlespectrum_8cpp_source.html#l00284">284</a> of file <a class="el" href="singlespectrum_8cpp_source.html">singlespectrum.cpp</a>.</p>

</div>
</div>
<a class="anchor" id="a68722e243799928f35696b91dd3eec99"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void SingleSpectrum::InitialBin </td>
          <td>(</td>
          <td class="paramtype">uint&#160;</td>
          <td class="paramname"><em>bin_points</em> = <code>32</code></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Perform initial binning of a raw power spectrum and initializes spectrum uncertainties. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">bin_points</td><td>The number of points that should be put into a single bin. </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="singlespectrum_8cpp_source.html#l00408">408</a> of file <a class="el" href="singlespectrum_8cpp_source.html">singlespectrum.cpp</a>.</p>

</div>
</div>
<a class="anchor" id="aff7c0ae4597282530e2e7bfbab305dcf"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void SingleSpectrum::KSVZWeight </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Convert spectrum from units of Excess power to units of <img class="formulaInl" alt="$ g_{\gamma\gamma} $" src="form_15.png"/>. </p>
<p>See Ed Daw's Thesis, pg. 113, eq. 5.3</p>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname">std::invalid_argument</td><td>Thrown if spectrum is not in units of ExcessPower. </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="singlespectrum_8cpp_source.html#l00356">356</a> of file <a class="el" href="singlespectrum_8cpp_source.html">singlespectrum.cpp</a>.</p>

</div>
</div>
<a class="anchor" id="a3069daec9b412a1d9a98b67cd9bc5aa2"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void SingleSpectrum::LorentzianWeight </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Weight each point in the spectrum by how far away it is from the center frequency. </p>
<p>Points are weighted as follows; Let <img class="formulaInl" alt="$ f_0 $" src="form_16.png"/> be the center frequency of the spectrum, <img class="formulaInl" alt="$ f(n) $" src="form_17.png"/> be the center frequency of the n'th bin (for <img class="formulaInl" alt="$ 0 \leq n \leq \text{size} $" src="form_18.png"/>, and Q be the quality factor. Then <img class="formulaInl" alt="$ \forall i \ \frac{P_i}{L(f,f_0,Q)} $" src="form_22.png"/> Where <img class="formulaInl" alt="$ L(f,f_0,Q) $" src="form_23.png"/> represents the Lorentzian function. </p>

<p>Definition at line <a class="el" href="singlespectrum_8cpp_source.html#l00339">339</a> of file <a class="el" href="singlespectrum_8cpp_source.html">singlespectrum.cpp</a>.</p>

</div>
</div>
<a class="anchor" id="ac39957d9b67a322272d1089aa6dd6c4c"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void SingleSpectrum::rebin </td>
          <td>(</td>
          <td class="paramtype">uint&#160;</td>
          <td class="paramname"><em>points_per_bin</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Rebin the current spectra, averaging all power spectrum points and uncertainties. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">points_per_bin</td><td>The number of points that should be averaged into a signal bin </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="singlespectrum_8cpp_source.html#l00487">487</a> of file <a class="el" href="singlespectrum_8cpp_source.html">singlespectrum.cpp</a>.</p>

</div>
</div>
<a class="anchor" id="a42c2d13e632ffc2d4f0931376c5b6e5b"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint SingleSpectrum::size </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>similar to std::vector::size(), get the number of points in the current spectrum. </p>
<p>Note that this corresponds to the number of power spectrum points but does not count the number of uncertainty values stored. </p>

<p>Definition at line <a class="el" href="singlespectrum_8cpp_source.html#l00059">59</a> of file <a class="el" href="singlespectrum_8cpp_source.html">singlespectrum.cpp</a>.</p>

</div>
</div>
<a class="anchor" id="a20a4b8c22c80d84341e4226f43a54c50"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::string SingleSpectrum::units </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Get the current units that the <a class="el" href="class_spectrum.html" title="Container class designed to hold all the individual spectra collected in a data run. ">Spectrum</a> is in. </p>
<p>Possible units are:</p>
<p>dBm<br />
Watts<br />
ExcessPower = Power above noise (in Watts)<br />
AxionPower = Power deposited or subtracted by axion signal in units of fraction of expected power as predicted by KSVZ theory<br />
ExclLimit90 = Not a true unit of power, 90% confidence limit on <img class="formulaInl" alt="$ g_{a\gamma\gamma} ( GeV^{-1} ) $" src="form_6.png"/></p>
<dl class="section return"><dt>Returns</dt><dd>string expressing the current units the spectrum is in </dd></dl>

<p>Definition at line <a class="el" href="singlespectrum_8cpp_source.html#l00376">376</a> of file <a class="el" href="singlespectrum_8cpp_source.html">singlespectrum.cpp</a>.</p>

</div>
</div>
<a class="anchor" id="aab066652966cbd493157ba60449e78ee"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void SingleSpectrum::WattsToExcessPower </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Convert from units of Watts to ExcessPower, i.e. Watts above power due to noise. </p>
<p>Convert from usings of watts to units of watts above noise (i.e. excess power)</p>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname">std::invalid_argument</td><td>Thrown if spectrum is not in units of Watts </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="singlespectrum_8cpp_source.html#l00301">301</a> of file <a class="el" href="singlespectrum_8cpp_source.html">singlespectrum.cpp</a>.</p>

</div>
</div>
<h2 class="groupheader">Friends And Related Function Documentation</h2>
<a class="anchor" id="a99a9383be5a37813742c991db9c468c2"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::pair&lt; uint, double &gt; AutoOptimize </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_single_spectrum.html">SingleSpectrum</a> &amp;&#160;</td>
          <td class="paramname"><em>spec</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint&#160;</td>
          <td class="paramname"><em>max_radius</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint&#160;</td>
          <td class="paramname"><em>max_sigma</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">friend</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Compute the ideal radius to be used for background subtraction using the UnsharpMask function. </p>
<p>We assume each spectra we collect will be a combination of white noise, static structure and (perhaps) and axion signal. We wish to remove the static structure from the rest of the signal using the UnsharpMask function. We need to be careful to remove as much of the static structure as possible without removing any of the actual signal. Since we assume our noise is white noise we know that our signal should follow the relationship that <img class="formulaInl" alt="$ \frac{\mu}{\sigma} \approx \frac{1}{\sqrt{N}} $" src="form_29.png"/> where N is the total number of points in the signal. This function will compute what parameter, as used by the UnsharpMask function, will yield a signal that is closest to satisfying the previous statement.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">spec</td><td>The spectrum that will later have static structure removed.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The kernel radius (as used by the UnsharpMask function) that will yield optimal background subtraction. </dd></dl>

</div>
</div>
<a class="anchor" id="a5e7f22c72498af588353d6f9dd2d249d"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void GaussianFilter </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_single_spectrum.html">SingleSpectrum</a> &amp;&#160;</td>
          <td class="paramname"><em>spec</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint&#160;</td>
          <td class="paramname"><em>radius</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">friend</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Convolve a <a class="el" href="class_single_spectrum.html" title="Class to hold a single power spectrum and its associated parameters, such as center frequency...">SingleSpectrum</a> object with a Gaussian kernel. </p>
<p>This has the effect of sending a <a class="el" href="class_single_spectrum.html" title="Class to hold a single power spectrum and its associated parameters, such as center frequency...">SingleSpectrum</a> object through a low-pass filter.</p>
<ul>
<li>Specifically this function computes the following: Given a <a class="el" href="class_single_spectrum.html" title="Class to hold a single power spectrum and its associated parameters, such as center frequency...">SingleSpectrum</a> S: <p class="formulaDsp">
<img class="formulaDsp" alt="\[ S*G \text{ for }\\ G[n] = \frac{1}{\sqrt{ \pi r} } e^{ \frac{2 n}{r}^2 } \text{ for } n \in [-r,r] \text{ and } r \in \mathbb{N} \]" src="form_28.png"/>
</p>
</li>
</ul>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">spec</td><td><a class="el" href="class_single_spectrum.html" title="Class to hold a single power spectrum and its associated parameters, such as center frequency...">SingleSpectrum</a> to be convolved. Note that this object -will be modified- and not copied.</td></tr>
    <tr><td class="paramname">radius</td><td>The radius of the Gaussian kernel used in the convolution. The radius implicitly sets the standard deviation of the kernel equal to 5/2*radius. </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="spectrumfilter_8cpp_source.html#l00357">357</a> of file <a class="el" href="spectrumfilter_8cpp_source.html">spectrumfilter.cpp</a>.</p>

</div>
</div>
<a class="anchor" id="a260e8ff3518714d32d964dd7e2a6bf39"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::ostream&amp; operator&lt;&lt; </td>
          <td>(</td>
          <td class="paramtype">std::ostream &amp;&#160;</td>
          <td class="paramname"><em>stream</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_single_spectrum.html">SingleSpectrum</a> &amp;&#160;</td>
          <td class="paramname"><em>spectrum</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">friend</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Operator for printing spectrum contents to std::cout or similar Only power data will be accessed and printed. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">stream</td><td>object </td></tr>
    <tr><td class="paramname">spectrum</td><td>to be printed </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>new stream object </dd></dl>

<p>Definition at line <a class="el" href="singlespectrum_8cpp_source.html#l00092">92</a> of file <a class="el" href="singlespectrum_8cpp_source.html">singlespectrum.cpp</a>.</p>

</div>
</div>
<a class="anchor" id="aa4fcc146ff71fd379f2e6dab83125c74"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::ofstream&amp; operator&lt;&lt; </td>
          <td>(</td>
          <td class="paramtype">std::ofstream &amp;&#160;</td>
          <td class="paramname"><em>stream</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_single_spectrum.html">SingleSpectrum</a> &amp;&#160;</td>
          <td class="paramname"><em>spectrum</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">friend</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Operator for saving spectra to files Unlike the ostream version, both the header and power data are accessed. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">stream</td><td>object </td></tr>
    <tr><td class="paramname">spectrum</td><td>to be saved </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>new stream object </dd></dl>

<p>Definition at line <a class="el" href="singlespectrum_8cpp_source.html#l00104">104</a> of file <a class="el" href="singlespectrum_8cpp_source.html">singlespectrum.cpp</a>.</p>

</div>
</div>
<a class="anchor" id="af6ea635ec0d3f68b648f1e4ce2f04a83"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void plot </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_single_spectrum.html">SingleSpectrum</a> &amp;&#160;</td>
          <td class="paramname"><em>spec</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::string&#160;</td>
          <td class="paramname"><em>plot_title</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::string&#160;</td>
          <td class="paramname"><em>save_file_path</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">friend</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Plot a <a class="el" href="class_single_spectrum.html" title="Class to hold a single power spectrum and its associated parameters, such as center frequency...">SingleSpectrum</a> object as a connected line graph. </p>
<p>Note that uncertainities will -not- be plotted, only power values</p><ul>
<li>further every power value will be plotted. If the spectrum contains a large number of points plotting will be very slow or fail.</li>
</ul>
<p>Units will be automatically be added to the graph, based on whatever the units the <a class="el" href="class_single_spectrum.html" title="Class to hold a single power spectrum and its associated parameters, such as center frequency...">SingleSpectrum</a> is currently in (tracked automatically).</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">spec</td><td>The <a class="el" href="class_single_spectrum.html" title="Class to hold a single power spectrum and its associated parameters, such as center frequency...">SingleSpectrum</a> class to be plotted</td></tr>
    <tr><td class="paramname">plot_title</td><td>The title that will appear on the graph </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="plotter_8cpp_source.html#l00015">15</a> of file <a class="el" href="plotter_8cpp_source.html">plotter.cpp</a>.</p>

</div>
</div>
<a class="anchor" id="a30c341f2a001107ecb26dfb82a41ab60"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void plot </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_single_spectrum.html">SingleSpectrum</a> &amp;&#160;</td>
          <td class="paramname"><em>spec</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint&#160;</td>
          <td class="paramname"><em>num_plot_points</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::string&#160;</td>
          <td class="paramname"><em>plot_title</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::string&#160;</td>
          <td class="paramname"><em>save_file_path</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">friend</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Plot a <a class="el" href="class_single_spectrum.html" title="Class to hold a single power spectrum and its associated parameters, such as center frequency...">SingleSpectrum</a> object as a point graphic with error bars. </p>
<p>Error bars are automatically generated using the uncertainities associated with <a class="el" href="class_single_spectrum.html" title="Class to hold a single power spectrum and its associated parameters, such as center frequency...">SingleSpectrum</a>.</p>
<p>Units will be automatically be added to the graph, based on whatever units the <a class="el" href="class_single_spectrum.html" title="Class to hold a single power spectrum and its associated parameters, such as center frequency...">SingleSpectrum</a> is currently in (tracked automatically).</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">spec</td><td>The <a class="el" href="class_single_spectrum.html" title="Class to hold a single power spectrum and its associated parameters, such as center frequency...">SingleSpectrum</a> class to be plotted</td></tr>
    <tr><td class="paramname">num_plot_points</td><td>The number of elements (and associated uncertainties) that should be plotted. This number should be less than or equal to the size of the <a class="el" href="class_single_spectrum.html" title="Class to hold a single power spectrum and its associated parameters, such as center frequency...">SingleSpectrum</a>, which can be found with the <a class="el" href="class_single_spectrum.html#a42c2d13e632ffc2d4f0931376c5b6e5b" title="similar to std::vector::size(), get the number of points in the current spectrum. ...">SingleSpectrum.size()</a> function.</td></tr>
    <tr><td class="paramname">plot_title</td><td>The title that will appear on the graph </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="plotter_8cpp_source.html#l00045">45</a> of file <a class="el" href="plotter_8cpp_source.html">plotter.cpp</a>.</p>

</div>
</div>
<a class="anchor" id="ad01cdeca98f7daa5c3c9d6b96debcaa2"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void UnsharpMask </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_single_spectrum.html">SingleSpectrum</a> &amp;&#160;</td>
          <td class="paramname"><em>spec</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint&#160;</td>
          <td class="paramname"><em>radius</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>sigma</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">friend</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Subtract background structure from a <a class="el" href="class_single_spectrum.html" title="Class to hold a single power spectrum and its associated parameters, such as center frequency...">SingleSpectrum</a> using a high-pass filter. </p>
<p>The filter uses the so-called unsharp mask technique- low-frequency structure is identified by convolving the original signal with a gaussian kernel. Then this static structure is subtracted from the original signal.</p>
<p>Specifically this function computes the following: Given a <a class="el" href="class_single_spectrum.html" title="Class to hold a single power spectrum and its associated parameters, such as center frequency...">SingleSpectrum</a> S: </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ S - S*G \text{ for }\\ G[n] = \frac{1}{\sqrt{ \pi r} } e^{ \frac{2 n}{r}^2 } \text{ for } n \in [-r,r] \text{ and } r \in \mathbb{N} \]" src="form_8.png"/>
</p>
<p>Edges effects are handled by mirroring edge-points.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">spec</td><td>The <a class="el" href="class_single_spectrum.html" title="Class to hold a single power spectrum and its associated parameters, such as center frequency...">SingleSpectrum</a> that requires background subtraction. Note that the spectrum -will be modified-, this function does not return a new spectrum.</td></tr>
    <tr><td class="paramname">radius</td><td>The radius of the Gaussian kernel used in the convolution. The radius implicitly sets the standard deviation of the kernel equal to 5/2*radius. </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="spectrumfilter_8cpp_source.html#l00361">361</a> of file <a class="el" href="spectrumfilter_8cpp_source.html">spectrumfilter.cpp</a>.</p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="class_single_spectrum.html">SingleSpectrum</a></li>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.11 </li>
  </ul>
</div>
</body>
</html>
